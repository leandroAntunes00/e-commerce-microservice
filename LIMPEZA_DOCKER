# üê≥ GUIA COMPLETO DE LIMPEZA DO DOCKER
# Para Iniciantes - Comandos Essenciais para Manuten√ß√£o

echo "=========================================="
echo "üê≥ LIMPEZA PROFUNDA DO DOCKER"
echo "=========================================="
echo ""

# 1. VERIFICAR ESPA√áO ATUAL
echo "üìä 1. VERIFICANDO ESPA√áO ATUAL OCUPADO:"
echo "Comando: docker system df"
echo "Por que? Mostra quanto espa√ßo cada componente do Docker est√° usando"
echo "Quando usar? Sempre antes e depois da limpeza para ver a diferen√ßa"
echo ""
docker system df
echo ""

# 2. VER IMAGENS ATUAIS
echo "üñºÔ∏è  2. VERIFICANDO IMAGENS INSTALADAS:"
echo "Comando: docker image ls"
echo "Por que? Lista todas as imagens locais com tamanho e data"
echo "Quando usar? Para ver quais imagens voc√™ tem antes de limpar"
echo ""
docker image ls
echo ""

# 3. LIMPAR IMAGENS N√ÉO UTILIZADAS (DANGLING)
echo "üóëÔ∏è  3. LIMPANDO IMAGENS N√ÉO UTILIZADAS:"
echo "Comando: docker image prune -f"
echo "O que faz:"
echo "  - Remove imagens 'dangling' (sem tag, √≥rf√£s)"
echo "  - Remove imagens intermedi√°rias de builds antigos"
echo "  - Mant√©m todas as imagens que est√£o sendo usadas"
echo "Por que importante? Libera espa√ßo de imagens esquecidas"
echo "Quando usar? Regularmente, especialmente ap√≥s muitos builds"
echo ""
docker image prune -f
echo ""

# 4. LIMPAR CONTAINERS PARADOS
echo "üì¶ 4. LIMPANDO CONTAINERS PARADOS:"
echo "Comando: docker container prune -f"
echo "O que faz:"
echo "  - Remove containers no estado 'exited' ou 'stopped'"
echo "  - Mant√©m containers em execu√ß√£o"
echo "  - Remove logs antigos dos containers"
echo "Por que importante? Containers parados ocupam espa√ßo desnecess√°rio"
echo "Quando usar? Ap√≥s testes ou desenvolvimento"
echo ""
docker container prune -f
echo ""

# 5. LIMPAR VOLUMES N√ÉO UTILIZADOS
echo "üíæ 5. LIMPANDO VOLUMES ORF√ÉOS:"
echo "Comando: docker volume prune -f"
echo "O que faz:"
echo "  - Remove volumes n√£o conectados a nenhum container"
echo "  - Mant√©m volumes de containers em execu√ß√£o"
echo "  - Remove dados antigos de bancos de dados, etc."
echo "Por que importante? Volumes podem conter GBs de dados esquecidos"
echo "Quando usar? Com cuidado! Verifique se n√£o h√° dados importantes"
echo ""
docker volume prune -f
echo ""

# 6. LIMPAR REDES N√ÉO UTILIZADAS
echo "üåê 6. LIMPANDO REDES N√ÉO UTILIZADAS:"
echo "Comando: docker network prune -f"
echo "O que faz:"
echo "  - Remove redes criadas automaticamente que n√£o s√£o usadas"
echo "  - Mant√©m redes padr√£o (bridge, host, none)"
echo "  - Mant√©m redes de stacks em execu√ß√£o"
echo "Por que importante? Redes antigas podem causar conflitos"
echo "Quando usar? Ap√≥s remover stacks ou containers"
echo ""
docker network prune -f
echo ""

# 7. LIMPAR CACHE DE BUILD
echo "üî® 7. LIMPANDO CACHE DE BUILD:"
echo "Comando: docker builder prune -f"
echo "O que faz:"
echo "  - Remove camadas intermedi√°rias de builds"
echo "  - Remove cache de Dockerfiles"
echo "  - Mant√©m apenas builds recentes"
echo "Por que importante? Builds antigos podem ocupar 10-50GB facilmente"
echo "Quando usar? Ap√≥s muitos builds de desenvolvimento"
echo ""
docker builder prune -f
echo ""

# 8. VERIFICAR ESPA√áO AP√ìS LIMPEZA
echo "üìä 8. VERIFICANDO ESPA√áO AP√ìS LIMPEZA:"
echo "Comando: docker system df"
echo "Por que? Comparar com o resultado inicial"
echo "Quando usar? Sempre ap√≥s limpeza para ver o resultado"
echo ""
docker system df
echo ""

# 9. LIMPEZA COMPLETA (OPCIONAL - MAIS AGRESSIVA)
echo "üí• 9. LIMPEZA COMPLETA (OPCIONAL - CUIDADO!):"
echo "Comando: docker system prune -a"
echo "O que faz:"
echo "  - Remove TUDO n√£o utilizado (imagens, containers, volumes, redes)"
echo "  - Remove at√© imagens sem containers associados"
echo "  - PERIGO: Pode remover imagens que voc√™ ainda precisa!"
echo "Por que importante? Limpeza total do sistema"
echo "Quando usar? APENAS se tiver certeza que n√£o precisa de nada"
echo ""
echo "‚ö†Ô∏è  ATEN√á√ÉO: Este comando remove tudo n√£o utilizado!"
echo "   Use apenas se souber exatamente o que est√° fazendo."
echo "   Comando comentado para seguran√ßa:"
echo "# docker system prune -a"
echo ""

echo "=========================================="
echo "‚úÖ LIMPEZA CONCLU√çDA!"
echo "=========================================="
echo ""
echo "üí° DICAS PARA MANUTEN√á√ÉO:"
echo "1. Execute limpeza semanal: docker system prune"
echo "2. Monitore espa√ßo: docker system df"
echo "3. Use .dockerignore para builds menores"
echo "4. Remova containers ap√≥s uso: docker rm <container>"
echo "5. Limpe builds antigos: docker image prune -a"
echo ""
echo "üîß COMANDOS √öTEIS DO DIA A DIA:"
echo "docker ps -a          # Ver todos containers"
echo "docker images         # Ver todas imagens"
echo "docker volume ls      # Ver volumes"
echo "docker network ls     # Ver redes"
echo "docker stats          # Ver uso de recursos"
echo ""
echo "üìö PARA APRENDER MAIS:"
echo "- Documenta√ß√£o: https://docs.docker.com/"
echo "- Docker Cheat Sheet: Busque no Google"
echo "- Pr√°tica: Use docker run hello-world"